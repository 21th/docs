---
title: 'Persistence'
---

- What is persistence/restoration?
- Why is it useful?
  - Frontend use-case
  - Backend use-case

```ts
const feedbackActor = interpret(feedbackMachine).start();

// Get state to be persisted
const persistedState = feedbackActor.getPersistedState();

// Persist state
localStorage.setItem('feedback', JSON.stringify(persistedState));

// Restore state
const restoredState = JSON.parse(localStorage.getItem('feedback'));

const restoredFeedbackActor = interpret(feedbackMachine, {
  state: restoredState,
}).start();
```

## Persisting state

- `actor.getPersistedState()`
- With machines
- Other actors can persist state too

## Restoring state

- `interpret(behavior, { state: restoredState }).start()`
- Actions are not replayed, because they are already executed
- Invocations are restarted

## Recursive persistence

- Invoked actors are persisted/restored recursively
- Spawned actors are persisted/restored recursively

## Strategies

- Storage
  - Localstorage
  - DB
  - Cookies
  - Filesystem
  - URL

# Caveats

- Incompatible state
- Desire to replay actions
- Consider [event sourcing](#)

# TypeScript

# Cheatsheet

- Persisting state
  - `actor.getPersistedState()`
- Restoring state
  - `interpret(behavior, { state: restoredState }).start()`

# Resources
